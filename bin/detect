#!/usr/bin/env bash

set -euo pipefail

BUILD_DIR="${1}"

BUILDPACK_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && cd .. && pwd)"

source "${BUILDPACK_DIR}/lib/common.sh"

## SBT 0.10 allows either *.sbt in the root dir, or project/*.scala or .sbt/*.scala
if detect_sbt "${BUILD_DIR}"; then
	if is_play "${BUILD_DIR}"; then
		PLAY_2_X="Play 2.x"
		DETECTED_PLAY_LANG="$(detect_play_lang "${BUILD_DIR}")"
		if [[ "${DETECTED_PLAY_LANG}" ]]; then
			echo "${PLAY_2_X} - ${DETECTED_PLAY_LANG}"
		else
			echo "${PLAY_2_X}"
		fi
	else
		echo "Scala"
	fi
	exit 0
else
	(>&2 echo "Could not find a 'build.sbt' file! Please ensure it exists and is checked into Git.")
	exit 1
fi
